% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_taxa_volatility_test_long.R
\name{generate_taxa_volatility_test_long}
\alias{generate_taxa_volatility_test_long}
\title{Longitudinal Taxa Abundance Volatility Test}
\usage{
generate_taxa_volatility_test_long(
  data.obj,
  time.var,
  subject.var,
  group.var,
  adj.vars = NULL,
  feature.level,
  feature.dat.type = c("count", "proportion", "other")
)
}
\arguments{
\item{data.obj}{A MicrobiomeStat data object. The heart of the MicrobiomeStat, consisting of several key components:
\itemize{
  \item \strong{Feature.tab (Matrix)}: Meeting point for research objects (OTU/ASV/KEGG/Gene, etc.) and samples.
  \item \strong{Meta.dat (Data frame)}: Rows correspond to the samples, and columns serve as annotations, describing the samples.
  \item \strong{Feature.ann (Matrix)}: Annotations, carrying classification information like Kingdom, Phylum, etc.
  \item \strong{Phylogenetic tree (Optional)}: An evolutionary perspective, illuminating the relationships among various research objects.
  \item \strong{Feature.agg.list (Optional)}: Aggregated results based on the feature.tab and feature.ann.
}}

\item{time.var}{A string. The name of the time variable in the metadata.}

\item{subject.var}{A string. The name of the subject variable in the metadata.}

\item{group.var}{A string. The grouping variable to test, found in metadata.}

\item{adj.vars}{A vector of strings. Covariates for adjustment in the linear models. Defaults to NULL.}

\item{feature.level}{A vector of strings. Taxonomic level(s) for aggregation, e.g. "Phylum", "Class".}

\item{feature.dat.type}{A string. Either 'count', 'proportion', or 'other'. Specifies the data type of feature for appropriate transformation.}
}
\value{
A list of test results. The results are returned in a tidy dataframe format, including coefficients, standard errors, statistics, and p-values from linear models and ANOVA tests.
}
\description{
This function calculates the volatility of taxa abundances in longitudinal microbiome data.
It tests for association between abundance volatility and a grouping variable.
}
\details{
Volatility is calculated as the mean absolute difference in abundance between
consecutive time points, normalized by time difference:
  mean(|abundance(t+1) - abundance(t)| / (time(t+1) - time(t)))

The function transforms the abundance data first before volatility calculation.
Default transform is 'CLR' for count and proportion data. No transform for other types.

For count data, a pseudocount of 0.5 is added before CLR transform.
For proportion data, zeros are replaced with 1/2 of the minimum positive value before CLR.

It then calculates volatility within each subject, and tests for association with
the grouping variable using linear models. If the grouping variable has multiple levels,
an ANOVA is performed.
}
\examples{
data("subset_T2D.obj")
subset_T2D.obj2 <- subset_T2D.obj
subset_T2D.obj2$meta.dat$visit_number <- as.numeric(subset_T2D.obj2$meta.dat$visit_number)
generate_taxa_volatility_test_long(
data.obj = subset_T2D.obj2,
time.var = "visit_number",
subject.var = "subject_id",
group.var = "subject_race",
adj.vars = "subject_gender",
feature.level = c("Phylum","Class"),
feature.dat.type = "count"
)
}
