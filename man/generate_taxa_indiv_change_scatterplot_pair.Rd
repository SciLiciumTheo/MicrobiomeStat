% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_taxa_indiv_change_scatterplot_pair.R
\name{generate_taxa_indiv_change_scatterplot_pair}
\alias{generate_taxa_indiv_change_scatterplot_pair}
\title{Generate taxa-level individual change scatterplot pairs}
\usage{
generate_taxa_indiv_change_scatterplot_pair(
  data.obj,
  subject.var,
  time.var,
  group.var = NULL,
  strata.var = NULL,
  change.base = NULL,
  change.func = "difference",
  feature.level = NULL,
  features.plot = NULL,
  feature.dat.type = c("count", "proportion", "other"),
  top.k.plot = NULL,
  top.k.func = NULL,
  prev.filter = 0.1,
  abund.filter = 0.1,
  base.size = 16,
  theme.choice = "bw",
  custom.theme = NULL,
  palette = NULL,
  pdf = TRUE,
  file.ann = NULL,
  pdf.wid = 11,
  pdf.hei = 8.5,
  ...
)
}
\arguments{
\item{data.obj}{A MicrobiomeStat data object containing the feature table, taxonomy table, and metadata.}

\item{subject.var}{Character string specifying the subject variable in the metadata.}

\item{time.var}{Character string specifying the time variable in the metadata.}

\item{group.var}{Character string specifying the grouping variable in the metadata. Default is NULL.}

\item{strata.var}{Character string specifying the stratification variable in the metadata. Default is NULL.}

\item{change.base}{Level of time variable to use as baseline for computing change.}

\item{change.func}{Function specifying how to compute change between time points. Default is "difference".}

\item{features.plot}{Character vector of specific taxa names to plot. Default NULL plots top taxa.}

\item{top.k.plot}{Integer specifying number of top taxa to plot if features.plot is NULL. Default NULL plots all passing filters.}

\item{top.k.func}{Function specifying metric for determining top k taxa. Default NULL uses row means.}

\item{prev.filter}{Numeric value specifying the minimum prevalence threshold for filtering taxa.}

\item{abund.filter}{Numeric value specifying the minimum abundance threshold for filtering taxa.}

\item{pdf}{Logical, if TRUE save plots as a multi-page PDF file. Default is TRUE.}

\item{file.ann}{Character string for file annotation to include in PDF file name. Default NULL.}

\item{...}{Additional arguments passed to ggsave().}

\item{taxa.level}{Character vector specifying the taxa level(s) to include. Default is c('Phylum', 'Family', 'Genus').}
}
\value{
A list of ggplot objects, one for each taxa level.
}
\description{
This function generates scatterplot pairs showing the change in abundance of taxa at different levels (Phylum, Family, or Genus) between two time points.
It allows users to compare the changes within and between different groups and strata.
}
\examples{
\dontrun{
 library(microbiome)
 library(vegan)
 library(tidyverse)

 # Load example data
 data(peerj32)
 peerj32.obj <- list()
 peerj32.phy <- peerj32$phyloseq
 peerj32.obj <- mStat_convert_phyloseq_to_data_obj(peerj32.phy)

 # Generate the scatterplot pairs
 plot_list <- generate_taxa_indiv_change_scatterplot_pair(
   data.obj = peerj32.obj,
   subject.var = "subject",
   time.var = "time",
   group.var = "cons",
   strata.var = "sex",
   change.base = "1",
   taxa.level = "Phylum",
   top.k.plot = 3,
   prev.filter = 0.1,
   abund.filter = 0.01
 )
}

}
