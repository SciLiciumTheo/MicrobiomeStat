% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_beta_pc_trend_test_long.R
\name{generate_beta_pc_trend_test_long}
\alias{generate_beta_pc_trend_test_long}
\title{Trend Test on Principal Coordinates of Beta Diversity Metrics Over Time}
\usage{
generate_beta_pc_trend_test_long(
  data.obj = NULL,
  dist.obj = NULL,
  pc.obj = NULL,
  pc.ind = c(1, 2),
  subject.var,
  time.var,
  group.var = NULL,
  adj.vars = NULL,
  dist.name = c("BC"),
  ...
)
}
\arguments{
\item{data.obj}{A list object in a format specific to MicrobiomeStat, which can include components such as feature.tab (matrix), feature.ann (matrix), meta.dat (data.frame), tree, and feature.agg.list (list). The data.obj can be converted from other formats using several functions from the MicrobiomeStat package, including: 'mStat_convert_DGEList_to_data_obj', 'mStat_convert_DESeqDataSet_to_data_obj', 'mStat_convert_phyloseq_to_data_obj', 'mStat_convert_SummarizedExperiment_to_data_obj', 'mStat_import_qiime2_as_data_obj', 'mStat_import_mothur_as_data_obj', 'mStat_import_dada2_as_data_obj', and 'mStat_import_biom_as_data_obj'. Alternatively, users can construct their own data.obj. Note that not all components of data.obj may be required for all functions in the MicrobiomeStat package.}

\item{dist.obj}{Distance matrix between samples, usually calculated using
\code{\link[MicrobiomeStat]{mStat_calculate_beta_diversity}} function.
If NULL, beta diversity will be automatically computed from \code{data.obj}
using \code{mStat_calculate_beta_diversity}.}

\item{pc.obj}{List of pre-calculated PCs matrices. Calculated by PCoA if NULL.
Includes PCs matrix for each distance matrix in dist.obj.}

\item{pc.ind}{Vector of indices (positive integers) indicating which PCs to include
in trend test. Should not exceed number of PCs calculated.}

\item{subject.var}{Name of subject ID variable in metadata (character).}

\item{time.var}{Name of time variable in metadata (numeric). Values should be
ordered sequentially.}

\item{group.var}{Name of grouping variable in metadata (character). Levels will be
used to fit separate models. Optional.}

\item{adj.vars}{Names of variables in metadata to adjust distance matrices for
(character). Optional.}

\item{dist.name}{Names of beta diversity distance measures to include, e.g.
"BC" for Bray-Curtis (character vector).}

\item{...}{Additional named arguments to pass to lmer():
\itemize{
\item control: Control parameters for lmer.
\item weights: Prior weights for the residuals.
}}
}
\value{
A nested list by distance > PC. Each element contains:
\itemize{
\item coef: Data frame of coefficients from mixed effects model.
\item model: Fitted lmer model object.
}
}
\description{
Performs linear trend tests on selected Principal Coordinates (PCs) of beta diversity
distance matrices over time, for different groups. Allows using PCoA, NMDS, t-SNE,
UMAP for dimension reduction, with PCoA as default.
}
\details{
This function allows performing linear trend tests on PCs of beta diversity
distances over time, across groups, with adjustments.

It checks for pre-calculated distances and PCs, generating them from data if needed.
Sufficient PCs should be calculated to cover indices specified.

For each distance, PCs are extracted for the selected indices. The metadata is
joined and formatted for mixed effects modeling with time as numeric.

The model formula is created using the response, time, group, and subject variables.
Mixed effects models are fitted with lmer() and coefficients extracted.
}
\examples{
\dontrun{
library(vegan)

  data(ecam.obj)
  generate_beta_pc_trend_test_long(
  data.obj = ecam.obj,
  dist.obj = NULL,
  pc.obj = NULL,
  pc.ind = c(1, 2),
  subject.var = "studyid",
  time.var = "month",
  group.var = "diet",
  adj.vars = "delivery",
  dist.name = c('BC')
)
}
}
\seealso{
\code{\link{mStat_calculate_beta_diversity}} to generate distance matrices.

\code{\link{mStat_calculate_PC}} to generate PCs from distances.
}
